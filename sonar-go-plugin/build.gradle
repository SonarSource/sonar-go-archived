plugins {
    id "com.github.johnrengelman.shadow" version "2.0.2"
}

apply plugin: 'java'

ext.junitJupiterVersion = '5.1.0'


dependencies {
    compile project(":common-rule-engine")

    compile "com.google.code.gson:gson:2.8.2"
    compile "org.sonarsource.analyzer-commons:sonar-analyzer-commons:1.5.0.178"
    compile "org.sonarsource.sonarqube:sonar-plugin-api:6.7"
    compileOnly 'com.google.code.findbugs:jsr305:1.3.9'

    runtime files(project(':uast-generator-go').buildDir)

    testCompile 'org.mockito:mockito-core:2.15.0'
    testCompile "org.assertj:assertj-core:3.9.0"
    testCompile "org.junit.jupiter:junit-jupiter-api:${junitJupiterVersion}"
    testRuntime "org.junit.jupiter:junit-jupiter-engine:${junitJupiterVersion}"
}

shadowJar {
    manifest {
        attributes(
                'Plugin-Key': 'go',
                'Plugin-Version': '1.0-SNAPSHOT',
                'Plugin-Class': 'org.sonar.go.plugin.GoPlugin',
                'Plugin-ChildFirstClassLoader': 'false',
                'Sonar-Version': '6.7',
                'SonarLint-Supported': 'true',
                'Plugin-Name': 'SonarGo',
                'Plugin-License': 'LGPLv3'
        )
    }
    dependencies {
        exclude(dependency("org.sonarsource.sonarqube:sonar-plugin-api:6.7"))
    }
}

artifacts {
    archives shadowJar
}
